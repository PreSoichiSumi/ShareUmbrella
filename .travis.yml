language: java
jdk: oraclejdk7
script: ant generate.service
after_success: ls -al &&  mkdir -p dpl_cd_upload && mv shareUmbrella.war dpl_cd_upload/shareUmbrella.war
deploy:
- provider: s3
  access_key_id: $AWS_ACCESS_KEY 
  secret_access_key: $AWS_SECRET_KEY
  local_dir: dpl_cd_upload
  skip_cleanup: true
  region: ap-northeast-1
  on: &2
    repo: SoichiSumi/ShareUmbrella
  bucket: shareumbrella
- provider: codedeploy
  access_key_id: AKIAID2JJWWUKSFS4YHA
  secret_access_key: *1
  bucket: shareumbrella
  key: AKIAJ3JYNSGLSW72LENQ
  bundle_type: github
  application: ShareUmbrella
  deployment_group: shareumbrella-deploymentgroup
  on: *2
